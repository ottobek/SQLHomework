# SQL Homework Tasks: CTEs and Derived Tables

This document contains a collection of SQL homework tasks divided into three difficulty levels: **Easy**, **Medium**, and **Difficult**.

---

## Easy Tasks (20)

1. Write a query to find the total sales per employee using a derived table.
2. Create a CTE to find the average salary of employees.
3. Write a query using a derived table to find the highest sales for each product.
4. Use a CTE to get the names of employees who have made more than 5 sales.
5. Create a derived table that lists the top 5 customers by total purchase amount.
6. Write a query using a CTE to find all products with sales greater than $500.
7. Use a derived table to get the total number of orders for each customer.
8. Create a CTE to find employees with salaries above the average salary.
9. Write a query to find the total number of products sold using a derived table.
10. Use a CTE to find the names of employees who have not made any sales.
11. Write a query using a derived table to calculate the total revenue for each region.
12. Use a CTE to get the employees who worked for more than 5 years.
13. Create a query using a derived table to find customers who made more than 3 orders.
14. Write a query using a CTE to find employees with the highest sales in a specific department.
15. Use a derived table to calculate the average order value for each customer.
16. Write a query using a CTE to find the number of employees in each department.
17. Use a derived table to find the top-selling products in the last quarter.
18. Write a query using a CTE to list employees who have sales higher than $1000.
19. Create a derived table to find the number of orders made by each customer.
20. Write a query using a CTE to find the total sales per employee for the last month.

---

## Medium Tasks (20)

1. Write a query using a CTE to calculate the running total of sales for each employee.
2. Use a recursive CTE to generate a sequence of numbers from 1 to 10.
3. Write a query using a derived table to calculate the average sales per region.
4. Create a CTE to rank employees based on their total sales.
5. Use a derived table to find the top 5 employees by the number of orders made.
6. Write a query using a recursive CTE to list all employees reporting to a specific manager.
7. Use a CTE to calculate the sales difference between the current month and the previous month.
8. Create a derived table to find the employees who have made the highest sales in each department.
9. Write a recursive CTE to find all the ancestors of an employee in a hierarchical organization.
10. Use a CTE to find employees who have not sold anything in the last year.
11. Write a query using a derived table to calculate the total sales per region and year.
12. Use a recursive CTE to calculate the factorial of a number.
13. Write a query using a derived table to find customers with more than 10 orders.
14. Create a recursive CTE to traverse a product category hierarchy.
15. Use a CTE to rank products based on total sales in the last year.
16. Write a query using a derived table to find the sales per product category.
17. Use a CTE to find the employees who achieved the highest sales growth compared to last year.
18. Create a derived table to find employees with sales over $5000 in each quarter.
19. Write a recursive CTE to list all descendants of a product in a product category tree.
20. Use a derived table to find the top 3 employees by total sales amount in the last month.

---

## Difficult Tasks (20)

1. Write a recursive CTE to generate the Fibonacci sequence up to the 20th term.
2. Use a CTE to calculate the cumulative sales of employees over the past year.
3. Write a recursive CTE to find all subordinates of a manager in a hierarchical company structure.
4. Create a query using a derived table to find employees with sales above the company average for each region.
5. Write a recursive CTE to calculate the depth of a product in a multi-level product hierarchy.
6. Create a complex query that uses both a CTE and a derived table to calculate sales totals for each department and product.
7. Use a recursive CTE to list all direct and indirect reports of a specific manager.
8. Write a query using a derived table to find the employees who have made the most sales in the last 6 months.
9. Create a recursive CTE to calculate the total cost of an order, including taxes and discounts.
10. Use a CTE to find the employees with the largest sales growth rate over the past year.
11. Write a recursive CTE to calculate the total number of sales for each employee over all years.
12. Create a query using both a CTE and a derived table to find the highest-selling product and the employee who sold it.
13. Write a recursive CTE to calculate all the generations of an organization’s hierarchy.
14. Use a CTE to find all employees who made sales greater than the average of their department’s sales.
15. Create a derived table to find the average sales per employee by region, considering only employees who made sales.
16. Write a recursive CTE to identify employees with a direct or indirect report relationship to a specific manager.
17. Use a CTE to calculate the average number of products sold by each employee in the last year.
18. Write a query using both a derived table and a CTE to analyze sales performance by employee and product category.
19. Use a recursive CTE to list all departments reporting to a specific parent department in a multi-level organizational structure.
20. Write a recursive CTE to calculate the number of levels in a product category hierarchy, where each category can have subcategories.
